!function(t){"use strict";"object"==typeof exports?module.exports=t("undefined"!=typeof angular?angular:require("angular"),"undefined"!=typeof Chart?Chart:require("chart.js")):"function"==typeof define&&define.amd?define(["angular","chart"],t):t(angular,Chart)}(function(t,r){"use strict";function e(){var e={},n={Chart:r,getOptions:function(r){var n=r&&e[r]||{};return t.extend({},e,n)}};this.setOptions=function(r,n){return n?void(e[r]=t.extend(e[r]||{},n)):(n=r,void(e=t.extend(e,n)))},this.$get=function(){return n}}function n(e,n){function o(t,r){return t&&r&&t.length&&r.length?Array.isArray(t[0])?t.length===r.length&&t.every(function(t,e){return t.length===r[e].length}):r.reduce(c,0)>0?t.length===r.length:!1:!1}function c(t,r){return t+r}function i(r,e,n,a){var o=null;return function(c){var i=e.getElementsAtEvent||e.getPointsAtEvent;if(i){var u=i.call(e,c);(a===!1||t.equals(o,u)===!1)&&(o=u,r[n](u,c),r.$apply())}}}function u(n,a){for(var o=t.copy(a.chartColours||e.getOptions(n).chartColours||r.defaults.global.colours);o.length<a.chartData.length;)o.push(a.getColour());return o.map(l)}function l(t){return"object"==typeof t&&null!==t?t:"string"==typeof t&&"#"===t[0]?s(g(t.substr(1))):h()}function h(){var t=[f(0,255),f(0,255),f(0,255)];return s(t)}function s(t){return{backgroundColor:d(t,.2),borderColor:d(t,1),pointBackgroundColor:d(t,1),pointBorderColor:"#fff",pointHoverBackgroundColor:"#fff",pointHoverBorderColor:d(t,.8)}}function f(t,r){return Math.floor(Math.random()*(r-t+1))+t}function d(t,r){return a?"rgb("+t.join(",")+")":"rgba("+t.concat(r).join(",")+")"}function g(t){var r=parseInt(t,16),e=r>>16&255,n=r>>8&255,a=255&r;return[e,n,a]}function p(r,e,n,a){return{labels:r,datasets:e.map(function(r,e){return t.extend({},a[e],{label:n[e],data:r,fill:!0})})}}function C(t,r){var e=t.parent(),n=e.find("chart-legend"),a="<chart-legend>"+r.generateLegend()+"</chart-legend>";n.length?n.replaceWith(a):e.append(a)}function v(t,r,e,n){t.data.datasets.forEach(function(t,e){for(var n=0;n<r[e].length;n++)t.data[n]=r[e][n]}),t.update(),e.$emit("chart-update",t),e.chartLegend&&"false"!==e.chartLegend&&C(n,t)}function y(t){return!t||Array.isArray(t)&&!t.length||"object"==typeof t&&!Object.keys(t).length}function b(n,a){var o=t.extend({},r.defaults.global,e.getOptions(n),a.chartOptions);return o.responsive}return function(r){return{restrict:"CA",scope:{getColour:"=?",chartType:"=",chartData:"=?",chartLabels:"=?",chartOptions:"=?",chartSeries:"=?",chartColours:"=?",chartLegend:"@",chartClick:"=?",chartHover:"=?"},link:function(c,l){function s(e,n){if(!y(e)&&!t.equals(e,n)){var a=r||c.chartType;a&&(d&&d.destroy(),f(a))}}function f(r){if(b(r,c)&&0===l[0].clientHeight&&0===g.clientHeight)return n(function(){f(r)},50,!1);if(c.chartData&&c.chartData.length){c.getColour="function"==typeof c.getColour?c.getColour:h,c.chartColours=u(r,c);var a=l[0],o=a.getContext("2d"),s=p(c.chartLabels,c.chartData,c.chartSeries||[],c.chartColours),v=t.extend({},e.getOptions(r),c.chartOptions);console.log(r),d=new e.Chart(o,{type:r.toLowerCase(),data:s,options:v}),c.$emit("chart-create",d),a.onclick=c.chartClick?i(c,d,"chartClick",!1):t.noop,a.onmousemove=c.chartHover?i(c,d,"chartHover",!0):t.noop,c.chartLegend&&"false"!==c.chartLegend&&C(l,d)}}var d,g=document.createElement("div");g.className="chart-container",l.replaceWith(g),g.appendChild(l[0]),a&&window.G_vmlCanvasManager.initElement(l[0]),c.$watch("chartData",function(t,e){if(t&&t.length&&(!Array.isArray(t[0])||t[0].length)){var n=r||c.chartType;if(n){if(d){if(o(t,e))return v(d,t,c,l);d.destroy()}f(n)}}},!0),c.$watch("chartSeries",s,!0),c.$watch("chartLabels",s,!0),c.$watch("chartOptions",s,!0),c.$watch("chartColours",s,!0),c.$watch("chartType",function(r,e){y(r)||t.equals(r,e)||(d&&d.destroy(),f(r))}),c.$on("$destroy",function(){d&&d.destroy()})}}}}r.defaults.global.responsive=!0,r.defaults.global.multiTooltipTemplate="<%if (datasetLabel){%><%=datasetLabel%>: <%}%><%= value %>",r.defaults.global.colours=["#97BBCD","#DCDCDC","#F7464A","#46BFBD","#FDB45C","#949FB1","#4D5360"];var a="object"==typeof window.G_vmlCanvasManager&&null!==window.G_vmlCanvasManager&&"function"==typeof window.G_vmlCanvasManager.initElement;return a&&(r.defaults.global.animation=!1),t.module("chart.js",[]).provider("ChartJs",e).factory("ChartJsFactory",["ChartJs","$timeout",n]).directive("chartBase",["ChartJsFactory",function(t){return new t}]).directive("chartLine",["ChartJsFactory",function(t){return new t("line")}]).directive("chartBar",["ChartJsFactory",function(t){return new t("bar")}]).directive("chartRadar",["ChartJsFactory",function(t){return new t("radar")}]).directive("chartDoughnut",["ChartJsFactory",function(t){return new t("doughnut")}]).directive("chartPie",["ChartJsFactory",function(t){return new t("pie")}]).directive("chartPolarArea",["ChartJsFactory",function(t){return new t("polarArea")}])});
//# sourceMappingURL=angular-chart.min.js.map
